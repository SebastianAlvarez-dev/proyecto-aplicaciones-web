
<!doctype html>
<html lang="es">
<head>
<script>
  // ProtecciÃ³n: bloquea acceso si no hay sesiÃ³n
  (function(){
    var usuario = localStorage.getItem('becasULEAM_user');
    if(!usuario){
      window.location.replace('login.html');
    }
  })();
</script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mis solicitudes Â· ULEAM</title>
  <link rel="stylesheet" href="css/estilos.css">
</head>
<body>

<header>
  <div class="container top">
    <div class="brand">
      <img src="assets/uleam-placeholder.png" alt="ULEAM">
      <strong>ULEAM Â· Becas y ayudas econÃ³micas</strong>
    </div>
    <nav>
      <a href="index.html">Inicio</a>
      <a href="becas.html">Becas</a>
      <a href="registro.html">Registro</a>
      <a href="ver-solicitudes.html">Mis solicitudes</a>
      <a href="perfil.html">Perfil</a>
      <a href="reporte-tecnico.html">Soporte</a>
      <a href="login.html">Login</a>
    </nav>

    <div class="user-menu">
      <span id="userNameHeader">Usuario â–¼</span>
      <div class="user-dropdown">
        <a href="perfil.html" class="btn light">ðŸ‘¤ Mi perfil</a>
        <button id="logoutBtn" class="btn secondary">ðŸ”’ Cerrar sesiÃ³n</button>
      </div>
    </div>

  </div>
</header>

<main class="container">
  <section class="red-panel">
    <h1>ðŸ“„ Mis solicitudes de becas</h1>
    <div style="margin:10px 0"><label for="filtroEstado"><strong>Filtrar:</strong></label>
      <select id="filtroEstado"><option value="todas">Todas</option><option value="Aprobada">Aprobadas</option><option value="Rechazada">Rechazadas</option><option value="En revisiÃ³n">Pendientes</option></select>
    </div>
  </section>
<div id="tablaSolicitudes" style="margin-top:20px;"></div>
</main>

<footer>
  <div class="container">
    <div>Â© ULEAM â€“ Sistema de Becas (prototipo acadÃ©mico)</div>
    <div><button class="btn light" onclick="logout()">Cerrar sesiÃ³n</button></div>
  </div>
</footer>
<script src="js/app.js"></script>


<script>
document.addEventListener('DOMContentLoaded', function(){
  const contenedor = document.getElementById('tablaSolicitudes');
  let solicitudes = JSON.parse(localStorage.getItem('solicitudes')) || [];

  if(solicitudes.length === 0){
    contenedor.innerHTML = '<p>No hay solicitudes registradas.</p>';
    return;
  }

  let tabla = '<table border="1" cellpadding="10" cellspacing="0" style="width:100%; border-collapse:collapse;">';
  tabla += '<tr style="background:#2e8b57; color:white;"><th>Tipo de Beca</th><th>Fecha</th><th>Estado</th></tr>';
  solicitudes.forEach(s => {
    tabla += `<tr><td>${s.tipo}</td><td>${s.fecha}</td><td>${s.estado}</td></tr>`;
  });
  tabla += '</table>';

  contenedor.innerHTML = tabla;
});
</script>


<script>
document.addEventListener('DOMContentLoaded', function(){
  const user = JSON.parse(localStorage.getItem('becasULEAM_user') || 'null');
  const correo = user && user.correo ? user.correo : null;
  const cont = document.getElementById('tablaSolicitudes');
  let solicitudes = JSON.parse(localStorage.getItem('solicitudes') || '[]');

  let visibles = solicitudes;
  if(user && user.rol !== 'admin'){
    visibles = solicitudes.filter(s => s.correo === correo);
  }

  if(visibles.length === 0){
    cont.innerHTML = '<p>No hay solicitudes para mostrar.</p>';
    return;
  }

  let tabla = '<table style="width:100%;border-collapse:collapse">';
  tabla += '<thead><tr style="background:#2e8b57;color:#fff;text-align:left"><th style="padding:10px;border:1px solid #ddd">Tipo de Beca</th><th style="padding:10px;border:1px solid #ddd">Fecha</th><th style="padding:10px;border:1px solid #ddd">Estado</th></tr></thead><tbody>';
  visibles.forEach(s => {
    const color = s.estado === 'Aprobada' ? '#16a34a' : (s.estado === 'Rechazada' ? '#dc2626' : '#6b7280');
    tabla += `<tr><td style="padding:10px;border:1px solid #ddd">${s.tipo}</td><td style="padding:10px;border:1px solid #ddd">${s.fecha}</td><td style="padding:10px;border:1px solid #ddd;color:${color};font-weight:700">${s.estado}</td></tr>`;
  });
  tabla += '</tbody></table>';
  cont.innerHTML = tabla;
});
</script>

</body>
</html>
